# =============================================================================
# Git Configuration
# =============================================================================
# Pager: delta (side-by-side diffs with syntax highlighting)
# Diff/Merge tool: Kaleidoscope
#
# Local settings: ~/.gitconfig.local (name, email - not in git)
#
# Key aliases:
#   git lol   - Pretty log graph
#   git st    - Short status
#   git amend - Amend without editing message
#   git undo  - Undo last commit (keep changes)
#   git recent - List branches by last commit date
# =============================================================================

# Include local config for user-specific settings (name, email)
[include]
    path = ~/.gitconfig.local

[color]
    ui = auto

[alias]
    stat = status
    st = status --short
    remove = rm
    ci = commit
    cia = commit -a
    ciaa = commit -a --amend
    cip = !git add -p && git ci
    cipa = !git add -p && git ci --amend
    br = branch
    co = checkout
    df = diff
    lg = log -p
    loll = log --graph --decorate --pretty=oneline --abbrev-commit
    lol = !git --no-pager loll
    lolal = log --graph --decorate --pretty=oneline --abbrev-commit --all
    lola = !git --no-pager lolal
    ls = ls-files
    unstash = stash pop
    log-merge = !git log $(git merge-base --octopus $(git log -1 --merges --pretty=format:%P $1))..$1 --graph --pretty=oneline --abbrev-commit --boundary
    log-all = !git log --graph --decorate --pretty=oneline --abbrev-commit --all $(git fsck --no-reflogs | grep commit | cut -d\\  -f3)
    git = !git
    x = !gitx
    man = help
    pop = stash pop
    cp = cherry-pick

    # Modern workflow aliases
    amend = commit --amend --no-edit
    fixup = commit --fixup
    undo = reset HEAD~1 --mixed
    unstage = reset HEAD --
    aliases = !git config --get-regexp alias | sort
    recent = branch --sort=-committerdate --format='%(committerdate:short) %(refname:short)'

[branch]
    autosetuprebase = always

[rebase]
    autoSquash = true
    autoStash = true

[fetch]
    prune = true

[push]
    default = current
    autoSetupRemote = true

[mergetool]
    keepBackup = true
    prompt = false

[core]
    excludesfile = ~/.gitignore
    editor = nvim

    # Treat spaces before tabs and all kinds of trailing whitespace as an error
    # [default] trailing-space: looks for spaces at the end of a line
    # [default] space-before-tab: looks for spaces before tabs at the beginning of a line
    whitespace = space-before-tab,-indent-with-non-tab,trailing-space

    # Make `git rebase` safer on OS X
    # More info: <http://www.git-tower.com/blog/make-git-rebase-safe-on-osx/>
    trustctime = false

[color]
    diff = auto
    status = auto
    branch = auto

[color "diff"]
    meta = yellow 

[apply]
    whitespace = nowarn

# Setup Kaleidoscope as my default diffing tool (because its awesome)
[difftool "Kaleidoscope"]
   cmd = ksdiff --partial-changeset --relative-path \"$MERGED\" -- \"$LOCAL\" \"$REMOTE\"
[mergetool "Kaleidoscope"]
   cmd = ksdiff --merge --output \"$MERGED\" --base \"$BASE\" -- \"$LOCAL\" --snapshot \"$REMOTE\" --snapshot
   trustExitCode = true
[diff]
   tool = Kaleidoscope
[difftool]
   prompt = false
[merge]
   tool = Kaleidoscope
[init]
	defaultBranch = main

# Delta - better diff viewer
[core]
    pager = delta

[interactive]
    diffFilter = delta --color-only

[delta]
    navigate = true
    side-by-side = true
    line-numbers = true
    syntax-theme = Dracula
